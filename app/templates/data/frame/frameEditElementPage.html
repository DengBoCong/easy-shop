{% extends "base/basic.html" %}
{% block title %}{% endblock %}
{% block css %}
<style>
    .label-required-next:after {
        top: 6px;
        right: 5px;
        color: red;
        content: '*';
        position: absolute;
        margin-left: 4px;
        font-weight: 700;
        line-height: 1.8em;
    }
</style>
{% endblock %}
{% block content %}

<div class="layui-tab layui-tab-brief">
    <div class="layui-form" style="padding: 20px 20px 0 0;">
        <div class="layui-form-item layui-hide">
            <input type="text" value=[[elementId]] class="layui-input" id="frame-remain-id">
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label label-required-next">Def</label>
            <div class="layui-input-block">
                    <textarea name="DEF" placeholder="请输入Def" value="" class="layui-textarea"
                              id="element-def" style="width: 100%;height: 50px;"></textarea>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">Lemma</label>
            <div class="layui-input-block">
                    <textarea name="LEMMA" placeholder="请输入LEMMA" value="" class="layui-textarea"
                              id="element-lemma" style="width: 100%;height: 50px;"></textarea>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">Sample</label>
            <div class="layui-input-block">
                    <textarea name="SAMPLE" placeholder="请输入Sample" value="" class="layui-textarea"
                              id="element-sample" style="width: 100%;height: 50px;"></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="frame-edit-element-submit">提交更新</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block js %}
<script>
    layui.config({
        base: '../static/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'form', 'element', 'frameAbout'], function () {
        var $ = layui.$
            , form = layui.form
            , element = layui.element
            , admin = layui.admin;

        admin.req({
            method: "get",
            url: 'api/data/get!element_filter_by_id?ID=' + $('#frame-remain-id').val().split("*")[0] + '&sampleId=' + $('#frame-remain-id').val().split("*")[1],
            done: function (res) {
                if (res.code == 0) {
                    $('#element-def').val(res.data.DEF)
                    $('#element-lemma').val(res.data.LEMMA)
                    $('#element-sample').val(res.data.SAMPLE)
                } else {
                    layer.msg(res.msg, {icon: 5});
                }
            }
        });

        form.on('submit(frame-edit-element-submit)', function (obj) {
            dataPost = obj.field
            dataPost['ID'] = $('#frame-remain-id').val().split("*")[0]
            dataPost['SAMPLE_ID'] = $('#frame-remain-id').val().split("*")[1]
            admin.req({
                method: "post",
                url: 'api/data/update!element_info',
                data: JSON.stringify(dataPost),
                done: function (res) {
                    if (res.code == 0) {
                        layer.msg(res.msg);
                    } else {
                        layer.msg(res.msg, {icon: 5});
                    }
                }
            });
        });
    })
</script>
{% endblock %}